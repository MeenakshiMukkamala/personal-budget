<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Login</title>
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:wght@500;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #eaf4ff;        
      --card: #ffffff;     
      --primary: #2b6cb0;  
      --primary-600: #2c5282;
      --error: #e53e3e;
      --success: #2f855a;
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }

    body {
      margin: 0;
      font-family: Inter, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      color: var(--text);
      background-color: #d6ebff; 
      display: grid;
      place-items: center;
      padding: 2rem;
    }

    .card {
      width: 100%;
      max-width: 420px;
      background: var(--card);
      border-radius: 20px;
      box-shadow: 0 10px 30px rgba(31, 63, 104, 0.15);
      padding: 2rem;
      position: relative;
      overflow: hidden;
    }

    .card::before {
      content: "";
      position: absolute;
      inset: -2px;
      border-radius: 22px;
      padding: 2px;
      background: linear-gradient(135deg, rgba(144,205,244,0.7), rgba(43,108,176,0.3));
      -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
      -webkit-mask-composite: xor; mask-composite: exclude;
      pointer-events: none;
    }

    .brand {
      display: flex; align-items: center; gap: .6rem; margin-bottom: 1rem;
    }
    .logo {
      width: 40px; height: 40px; border-radius: 12px; background: linear-gradient(135deg, #63b3ed, #4299e1);
      display: grid; place-items: center; color: white; font-weight: 700; font-family: Poppins, Inter, sans-serif;
      box-shadow: 0 6px 18px rgba(66,153,225,.35);
    }

    h1 { font-family: Poppins, Inter, sans-serif; font-weight: 600; font-size: 1.4rem; margin: 0; }
    p.sub { color: var(--muted); margin: .25rem 0 1.25rem; font-size: .95rem; }

    form { display: grid; gap: 1rem; }
    label { font-weight: 600; font-size: .9rem; }

    .field { display: grid; gap: .4rem; }

    .input {
      width: 100%;
      padding: .85rem 1rem;
      border: 1.5px solid #cfe8ff;
      border-radius: 12px;
      background: #f8fbff;
      color: var(--text);
      outline: none;
      transition: box-shadow .2s, border-color .2s, background .2s;
      font-size: 1rem;
    }

    .input:focus {
      border-color: var(--ring);
      box-shadow: 0 0 0 4px rgba(99, 179, 237, .25);
      background: white;
    }

    .password-wrap { position: relative; }
    .toggle-btn {
      position: absolute; right: .5rem; top: 50%; transform: translateY(-50%);
      border: 0; background: transparent; cursor: pointer; padding: .35rem .5rem; border-radius: 8px; color: var(--primary);
    }
    .toggle-btn:focus { outline: 2px solid var(--ring); outline-offset: 2px; }

    .actions { display: flex; align-items: center; justify-content: space-between; gap: .75rem; }

    .btn {
      appearance: none; border: 0; cursor: pointer; border-radius: 12px; padding: .85rem 1rem; font-weight: 600;
      transition: transform .03s ease, box-shadow .2s ease, background-color .2s ease; font-family: Inter, system-ui, sans-serif;
    }

    .btn-primary {
      background: linear-gradient(180deg, #4299e1, #2b6cb0);
      color: white;
      box-shadow: 0 8px 18px rgba(66,153,225,.35);
    }
    .btn-primary:hover { filter: brightness(1.05); }
    .btn-primary:active { transform: translateY(1px); }
    .btn-primary:disabled { opacity: .6; cursor: not-allowed; box-shadow: none; }

    .helper { display: flex; align-items: center; gap: .5rem; color: var(--muted); font-size: .9rem; }

    .notice { font-size: .9rem; margin-top: .25rem; min-height: 1.25rem; }
    .notice.error { color: var(--error); }
    .notice.success { color: var(--success); }

    .footer { margin-top: 1.25rem; text-align: center; color: var(--muted); font-size: .9rem; }
    a { color: var(--primary); text-decoration: none; }
    a:hover { text-decoration: underline; }
  </style>
</head>
<body>
  <main class="card" aria-labelledby="title">
    <div class="brand" aria-hidden="true">
      <div class="logo">EB</div>
      <h1 id="title">Welcome</h1>
    </div>
    <p class="sub">Log in to continue to your Envelope Budget.</p>

    <form id="loginForm" novalidate>
      <div class="field">
        <label for="email">Email</label>
        <input id="email" name="email" type="email" class="input" placeholder="you@example.com" required />
      </div>

      <div class="field">
        <label for="password">Password</label>
        <div class="password-wrap">
          <input id="password" name="password" type="password" class="input" placeholder="••••••••" minlength="6" required />
          <button type="button" class="toggle-btn" aria-label="Show password" id="togglePw">Show</button>
        </div>
      </div>


      <div class="notice" id="notice" role="status" aria-live="polite"></div>
    </form>

    <div class="footer">
        <span>Don’t have an account?</span> <a href="signup.html">Sign up</a>
    </div>
  </main>

  <script>
    // Enable button only when form is valid
    const form = document.getElementById('loginForm');
    const email = document.getElementById('email');
    const password = document.getElementById('password');
    const submitBtn = document.getElementById('submitBtn');
    const togglePw = document.getElementById('togglePw');
    const notice = document.getElementById('notice');

    function validate() {
      submitBtn.disabled = !(email.value.trim() && password.value.length >= 6 && email.validity.valid);
    }
    email.addEventListener('input', validate);
    password.addEventListener('input', validate);

    // Show/Hide password
    togglePw.addEventListener('click', () => {
      const isHidden = password.type === 'password';
      password.type = isHidden ? 'text' : 'password';
      togglePw.textContent = isHidden ? 'Hide' : 'Show';
      togglePw.setAttribute('aria-label', isHidden ? 'Hide password' : 'Show password');
      password.focus();
    });

    // Handle submit (demo: POST to /login)
    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      notice.textContent = '';

      try {
        const res = await fetch('/login', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ email: email.value.trim(), password: password.value })
        });

        if (!res.ok) {
          const err = await res.json().catch(() => ({ error: 'Login failed' }));
          throw new Error(err.error || 'Login failed');
        }

        const data = await res.json();
        notice.className = 'notice success';
        notice.textContent = data.message || 'Logged in!';
        // TODO: redirect to dashboard
      } catch (err) {
        notice.className = 'notice error';
        notice.textContent = err.message || 'Something went wrong';
      }
    });
  </script>
</body>
</html>
